# Octofleet PXE Server - dnsmasq ProxyDHCP Configuration
# LÃ¤uft parallel zu deinem bestehenden DHCP!

# ============================================================
# PROXY DHCP MODE - Dein DHCP bleibt aktiv!
# ============================================================

# Kein DNS
port=0

# ProxyDHCP Mode - antwortet nur mit Boot-Info, keine IP-Vergabe
dhcp-range=192.168.0.0,proxy

# ============================================================
# REGISTRIERTE MACs - Nur diese bekommen PXE Boot
# ============================================================
# Format: dhcp-host=MAC,set:pxe
# Wird dynamisch aus /etc/hosts.pxe geladen
conf-file=/etc/hosts.pxe

# ============================================================
# PXE BOOT CONFIGURATION
# ============================================================

# BIOS PXE Boot
dhcp-match=set:bios,option:client-arch,0
dhcp-boot=tag:bios,tag:pxe,undionly.kpxe

# UEFI PXE Boot (x64)
dhcp-match=set:efi64,option:client-arch,7
dhcp-match=set:efi64,option:client-arch,9
dhcp-boot=tag:efi64,tag:pxe,ipxe.efi

# iPXE erkennen und chainloaden
dhcp-match=set:ipxe,175
dhcp-boot=tag:ipxe,tag:pxe,http://${PXE_SERVER_IP}:8888/boot.ipxe

# ============================================================
# TFTP SERVER
# ============================================================
enable-tftp
tftp-root=/tftpboot
tftp-secure

# ============================================================
# LOGGING
# ============================================================
log-dhcp
log-queries
log-facility=-
