{
  "name": "nginx-webserver",
  "displayName": "Nginx Web Server",
  "description": "Production-ready nginx reverse proxy / web server",
  "version": "1.0.0",
  "category": "web",
  "packages": {
    "debian": ["nginx"],
    "rhel": ["nginx"],
    "windows": ["nginx"]
  },
  "configFiles": [
    {
      "path": "/etc/nginx/sites-available/{{service_name}}",
      "template": "server {\n    listen {{port|default:80}};\n    server_name {{domain|default:_}};\n\n    {{#if ssl}}\n    listen 443 ssl;\n    ssl_certificate /etc/ssl/certs/{{domain}}.crt;\n    ssl_certificate_key /etc/ssl/private/{{domain}}.key;\n    {{/if}}\n\n    location / {\n        {{#if upstream}}\n        proxy_pass http://{{upstream}};\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        {{else}}\n        root {{root|default:/var/www/html}};\n        index index.html index.htm;\n        {{/if}}\n    }\n\n    location /healthz {\n        access_log off;\n        return 200 'healthy';\n        add_header Content-Type text/plain;\n    }\n}\n",
      "enableCommand": "ln -sf /etc/nginx/sites-available/{{service_name}} /etc/nginx/sites-enabled/",
      "reloadCommand": "nginx -t && systemctl reload nginx"
    }
  ],
  "services": {
    "linux": "nginx",
    "windows": "nginx"
  },
  "healthCheck": {
    "type": "http",
    "path": "/healthz",
    "port": "{{port|default:80}}",
    "expectedStatus": 200,
    "intervalSeconds": 30,
    "timeoutSeconds": 5
  },
  "commands": {
    "start": {
      "linux": "systemctl start nginx",
      "windows": "Start-Service nginx"
    },
    "stop": {
      "linux": "systemctl stop nginx",
      "windows": "Stop-Service nginx"
    },
    "reload": {
      "linux": "systemctl reload nginx",
      "windows": "nginx -s reload"
    }
  }
}
